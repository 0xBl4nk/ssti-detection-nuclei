id: ssti-detection-template

info:
  name: SSTI Detection
  author: BlackHatGPT
  severity: high
  tags: ssti, template-injection

requests:
  - method: GET
    path:
      - "{{BaseURL}}?{{param}}={{ssti_payload}}"

    headers:
      User-Agent: nuclei
      Accept: "*/*"

    payloads:
      ssti_payload:
        - "{{234234*2}}"           # Jinja2/Twig
        - "{$234234*2}"            # Smarty
        - "#set($x=234234*2)$x"    # Velocity
        - "<#assign x=234234*2>${x}"  # Freemarker
        - "th:text=\"${234234*2}\""   # Thymeleaf
        - "<%%=234234*2%%>"        # ERB
        - "{{234234*2}}"           # Handlebars
        - "{{234234*2}}"           # Mustache
        - "{{234234*2}}"           # Django
        - "<%%=234234*2%%>"        # Ruby
        - "${234234*2}"            # Java
        - "{{234234*2}}"           # Python
        - "<?=234234*2?>"          # PHP
        - "{{234234*2}}<%%=234234*2%%>"  # Polyglot

    matchers-condition: or
    matchers:
      - type: word
        words:
          - "Rendered: 468468"

      - type: regex
        regex:
          - "Rendered:.*468468"
